<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<META Version='1' >
<META App='Access'
Project='acmain9.chm'
FileName='acobjCreateKeyX'
Feature='acobj'
Handoff='3'
SourceFile='acaNewX.doc'
Tnum='281553'
Piece='1043'
Recycle='N'
>

<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Esempio di creazione di una chiave</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" type="text/css" href="/MSOffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<P class=RLNSR><B><A NAME="acobjcreatekeyx"></A>Esempio di creazione di una chiave</B></P>



<P class=T>Nell'esempio riportato di seguito viene creato un nuovo oggetto <B>Key</B> che definisce una relazione tra una tabella Categorie e una tabella Prodotti. La tabella Categorie è la tabella primaria della relazione mentre la tabella Prodotti è la tabella esterna. Il campo IDCategoria costituisce la chiave primaria della tabella Categorie e la chiave esterna della tabella Prodotti.</P>

<P class=T>Per fare un test di questo esempio nel database modello Northwind, dal menu <B>Strumenti</B> scegliere <B>Relazioni</B> ed eliminare la relazione tra la tabella Categorie e la tabella Prodotti. Chiudere la finestra Relazioni e, alla richiesta, salvare la configurazione corrente. Eseguire la routine indicata di seguito, quindi aprire di nuovo la finestra Relazioni per visualizzare la nuova relazione.</P>

<P class=T><B>Nota</B>&nbsp;&nbsp; Attualmente la creazione delle chiavi esterne non è supportata nei progetti di Access (adp) se si usa la versione del provider SQL fornita con Microsoft Access 2000. È necessario impostare un riferimento a "Microsoft ADO ext. 2.1 for DDL and Security" per utilizzare questo esempio.</P>

<PRE class=CT><CODE>Sub CreaChiaveEsterna()
&nbsp;&nbsp; Sub CreaChiave()
&nbsp;&nbsp;&nbsp; Dim Rel As New ADOX.Key
&nbsp;&nbsp;&nbsp; Dim cat As New ADOX.Catalog
&nbsp;&nbsp;&nbsp; cat.ActiveConnection = CurrentProject.Connection

&nbsp;&nbsp;&nbsp; With Rel
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Name = "CatProd"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Type = adKeyForeign
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .RelatedTable = "Categorie"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Columns.Append "IDCategoria"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Columns("IDCategoria").RelatedColumn = "IDCategoria"
&nbsp;&nbsp;&nbsp; End With
&nbsp;&nbsp;&nbsp; cat.Tables("Prodotti").Keys.Append Rel
End Sub
</CODE></PRE>


<P>
<OBJECT ID="hhobj_AR" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM NAME="Command" VALUE="ALink">
<PARAM NAME="Font" VALUE="Verdana,8,1">
<PARAM NAME="Text" VALUE="Text:Risorse aggiuntive">
<PARAM NAME="Flags" VALUE=",,1">
<PARAM NAME="Item1" VALUE="">
<PARAM NAME="Item2" VALUE="acobjCreateKeyXW">
</OBJECT>
</P>


<SCRIPT language="VBScript" src="ShowMe_Code.vbs"></SCRIPT>
<SCRIPT language="VBSCRIPT">
Sub HelpPopup (sFile, sID)
Call InitConstants() 
On Error Resume Next
r=oua.HelpPopup(sFile,sID)
If Err<>0 Then Msgbox L_SECURITY_MSG,48,L_TITLE
End Sub
</SCRIPT>

</BODY>
</HTML>

