<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<META Version='2' >
<META App='Access'
Project='acmain9.chm'
FileName='acfctDLookup'
Feature='acfct'
Handoff='1'
SourceFile='domain_1a.doc'
Tnum='187182'
Piece='1042'
Recycle='Y'
>

<OBJECT ID="oua" WIDTH="0" HEIGHT="0"
   CLASSID="CLSID:8936033C-4A50-11D1-98A4-00A0C90F27C6">
</OBJECT>

<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Funzione DLookup</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" type="text/css" href="/MSOffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<TABLE ALIGN=right WIDTH=0 BORDER=0><TR><TD>
<OBJECT ID="hhobj_3" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="daidxAggregateFunctions">
</OBJECT>
<OBJECT ID="hhobj_4" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="damthUpdate">
</OBJECT>
</TD></TR></TABLE>



<H1 class=RH1><A NAME="acfctdlookup"></A>Funzione DLookup</H1>

<P class=ALNSR>
<OBJECT ID="hhobj_1" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:Vedere anche">
	<PARAM NAME="Flags" VALUE="1,,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="acfctDLookupC">
</OBJECT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<OBJECT ID="hhobj_2" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
	<PARAM NAME="Command" VALUE="ALink">
	<PARAM NAME="Font" VALUE="Verdana,8,1">
	<PARAM NAME="Text" VALUE="Text:Esempio">
	<PARAM NAME="Flags" VALUE=",,1">
	<PARAM NAME="Item1" VALUE="">
	<PARAM NAME="Item2" VALUE="acfctDLookupX">
</OBJECT></P>



<P class=T>È possibile utilizzare la funzione <B>DLookup</B> per ottenere il valore di un determinato campo da un set di record specificato, un <A HREF="javascript:HelpPopup('actip9.hlp','defDomain');" class="pop">dominio</A>. Utilizzare la funzione <B>DLookup</B> in Visual Basic, in una <A HREF="javascript:HelpPopup('actip9.hlp','defScript');" class="pop">macro</A>, in una espressione nella query o in un <A HREF="javascript:HelpPopup('actip9.hlp','defCalculatedControl');" class="pop">controllo calcolato</A> di una maschera o di un report.</P>

<P class=T>È possibile utilizzare la funzione <B>DLookup</B> per visualizzare il valore di un campo che non si trova nell'origine record per la maschera o per il report. Se ad esempio si dispone di una maschera basata su una tabella Dettagli ordini, la maschera visualizza i campi IDOrdine, IDProdotto, PrezzoUnitario, Quantità e Sconto. Il campo Nome prodotto tuttavia è in un'altra tabella. È possibile utilizzare la funzione <B>DLookup</B> in un controllo calcolato per visualizzare il Nome prodotto sulla stessa maschera.</P>

<P class=RL><B>Sintassi</B></P>

<P class=SYN><B>DLookup(</B><I>espr</I>, <I>dominio</I>[, <I>criteri</I>]<B>)</B></P>



<P class=T>La funzione <B>DLookup</B> dispone degli argomenti riportati di seguito.</P>

<TABLE cellpadding=4 cellspacing=4 cols=2>

<TR VALIGN="top">
<TH width=25%>Argomento</TH>
<TH width=75%>Descrizione</TH>
</TR>

<TR VALIGN="top">
<TD class=TT width=25%><I>espr</I></TD>
<TD class=TT width=75%>Un'espressione che identifica il campo di cui si desidera restituire il valore. È possibile che si tratti di un'<A HREF="javascript:HelpPopup('actip9.hlp','defStringExpression');" class="pop">espressione stringa</A> che identifica un campo in una tabella o in una query oppure un'espressione che esegue <A HREF="achowFieldCalcDomain.htm">un calcolo dei campi</A>. In <I>espr</I> è possibile includere il nome di un campo in una tabella, un controllo in una maschera, una costante o una funzione. Se <I>espr</I> include una funzione, è possibile che sia incorporata o definita dall'utente, ma non è possibile che si tratti di un'altra funzione di aggregazione sui domini o di <A HREF="JavaScript:hhobj_3.Click()">aggregazione SQL</A>.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=25%><I>dominio</I></TD>
<TD class=TT width=75%>Un'espressione stringa che identifica il set di record che costituisce il dominio. È possibile che sia un nome di tabella o di query.</TD>
</TR>

<TR VALIGN="top">
<TD class=TT width=25%><I>criteri</I></TD>
<TD class=TT width=75%>Una stringa opzionale utilizzata per limitare l'intervallo di dati sui cui viene eseguita la funzione <B>DLookup</B>. L'argomento <I>criteri</I> ad esempio equivale spesso alla proposizione WHERE priva della parola WHERE in un'espressione SQL. Se si omette l'argomento <I>criteri</I>, la funzione <B>DLookup</B> valuta <I>espr</I> confrontandolo con l'intero dominio. È necessario che qualsiasi campo incluso in <I>criteri</I> appartenga anche all'argomento <I>dominio</I>. In caso contrario, la funzione <B>DLookup</B> restituisce un valore <A HREF="javascript:HelpPopup('actip9.hlp','defNull');" class="pop"><B>Null</B></A>.</TD>
</TR>
</TABLE><BR>



<P class=RL><B>Osservazioni</B></P>

<P class=T>La funzione <B>DLookup</B> restituisce un unico valore di campo basato sulle informazioni specificate in <I>criteri</I>. Anche se <I>criteri</I> è un argomento opzionale, se non si inserisce un valore per <I>criteri</I>, la funzione <B>DLookup</B> restituisce semplicemente un valore casuale contenuto nel dominio.</P>

<P class=T>Se nessun record soddisfa l'argomento <I>criteri</I> o se <I>dominio</I> non contiene record, la funzione <B>DLookup</B> restituisce un valore <B>Null</B>.</P>

<P class=T>Se più di un campo soddisfa i criteri, la funzione <B>DLookup</B> restituisce la prima ricorrenza. Si consiglia di specificare i criteri che assicureranno che il valore di campo restituito dalla funzione <B>DLookup</B> è univoco. È possibile che si desideri utilizzare un valore della <A HREF="javascript:HelpPopup('actip9.hlp','defPrimaryKey');" class="pop">chiave primaria</A> per i criteri, come <CODE>[IDImpiegato]</CODE> nell'esempio riportato di seguito, per avere la certezza che la funzione <B>DLookup</B> restituisca un valore univoco.</P>

<PRE class=CT><CODE>Dim varX As Variant
varX = DLookup("[Cognome]", " Impiegati ", "[IDImpiegato] = 1")</CODE></PRE>



<P class=T>Sia che la funzione <B>DLookup</B> venga utilizzata in una macro o in un modulo, in un'espressione nella query o in un controllo calcolato, è necessario creare l'argomento <I>criteri</I> con attenzione per assicurarsi che venga valutato correttamente.</P>

<P class=T>È possibile utilizzare la funzione <B>DLookup</B> per specificare i criteri nella riga <B>Criteri</B> di una query all'interno di un'espressione di campo calcolato in una query o nella riga <B>Aggiorna a</B> in una <A HREF="javascript:HelpPopup('actip9.hlp','defUpdateQuery');" class="pop">query di aggiornamento</A>.</P>

<P class=T>È inoltre possibile utilizzare la funzione <B>DLookup</B> in un'espressione di un controllo calcolato in una maschera o in un report se il campo che occorre visualizzare non si trova nell'origine record su cui si basa la maschera o il report. Si supponga ad esempio di disporre di una maschera Dettagli ordini in base a una tabella Dettagli ordini con una casella di testo chiamata IDProdotto in cui viene visualizzato il campo IDProdotto. Per cercare NomeProdotto da una tabella Prodotto in base al valore contenuto nella casella di testo, è possibile creare un'altra casella di testo e impostare la relativa proprietà <A HREF="acproControlSource.htm"><B>Origine controllo</B></A> come segue:</P>

<PRE class=CT><CODE>=DLookup("[NomeProdotto]", "Prodotti", "[IDProdotto] =" _
&nbsp;&nbsp;&nbsp;&nbsp; &amp; Forms![Dettagli Ordini]!IDProdotto)</CODE></PRE>



<P class=NT><B>Suggerimento</B>

<UL>
	<LI class=NLB>Anche se è possibile utilizzare la funzione <B>DLookup</B> per visualizzare un valore di un campo contenuto in una <A HREF="javascript:HelpPopup('actip9.hlp','defForeignTable');" class="pop">tabella esterna</A>, potrebbe risultare più pratico creare una query contenente i campi necessari da entrambe le tabelle e quindi basare la maschera o il report su tale query.<BR><BR></LI>

	<LI class=NLB>È inoltre possibile utilizzare la Creazione guidata Ricerca per cercare valori contenuti in una tabella correlata.</LI>
</UL>



<P class=NT><B>Nota</B>&nbsp;&nbsp; Le modifiche ai record che non vengono salvate in <I>dominio</I> non vengono incluse quando si utilizza la funzione. Se si desidera che la funzione <B>DLookup</B> sia basata sui valori modificati, è necessario prima salvare le modifiche scegliendo il comando <B>Salva record</B> dal menu <B>File</B>, spostando lo stato attivo su un altro record oppure utilizzando il metodo <A HREF="JavaScript:hhobj_4.Click()"><B>Update</B></A>.</P>


<SCRIPT language="VBScript" src="ShowMe_Code.vbs"></SCRIPT>
<SCRIPT language="VBSCRIPT">
Sub HelpPopup(sFile,sID)
L_SecurityT1_ErrorMessage="Impossibile visualizzare la procedura per la presenza di impostazioni di protezione "
L_SecurityT2_ErrorMessage="del browser troppo restrittive o per l'errata installazione del controllo ActiveX "
L_SecurityT3_ErrorMessage="Ouactrl.ocx."
L_SecurityE1_ErrorMessage="- Impostare un livello inferiore di protezione del browser"
L_SecurityE2_ErrorMessage="- Se questo messaggio viene visualizzato dopo l'impostazione di un livello inferiore,"
L_SecurityE3_ErrorMessage="  rivolgersi all'amministratore di sistema per la verifica dell'installazione del controllo"
L_SecurityE4_ErrorMessage="  ActiveX Ouactrl.ocx, posto nella cartella in cui è installato Microsoft Office"
sSecurityMSG=L_SecurityT1_ErrorMessage & chr(13) & L_SecurityT2_ErrorMessage & chr(13) & L_SecurityT3_ErrorMessage & chr(13) & chr(13) & L_SecurityE1_ErrorMessage & chr(13) & L_SecurityE2_ErrorMessage & chr(13) & L_SecurityE3_ErrorMessage & chr(13) & L_SecurityE4_ErrorMessage
L_App_DialogTitle="Guida di Microsoft Office"
On Error Resume Next
r=oua.HelpPopup(sFile,sID)
If Err<>0 Then Msgbox sSecurityMSG,48,L_App_DialogTitle
End Sub
</SCRIPT>
</BODY>
</HTML>
