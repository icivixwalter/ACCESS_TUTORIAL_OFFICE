<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<META Version='1' >
<META App='Access'
Project='acmain9.chm'
FileName='acconExampleMacroValidationS'
Feature='Macros'
Handoff='3'
SourceFile='cmactsk.rtf'
Tnum='186752'
Piece='1041'
Recycle='N'
>

<OBJECT ID="oua" WIDTH="0" HEIGHT="0"
   CLASSID="CLSID:8936033C-4A50-11D1-98A4-00A0C90F27C6">
</OBJECT>

<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Esempio di convalida dei dati utilizzando una macro</TITLE>
<style>@import url(/Office.css);</style>
<link disabled rel="stylesheet" type="text/css" href="/MSOffice.css"></HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">



<H1><A NAME="acconexamplemacrovalidations"></A>Esempio di convalida dei dati utilizzando una macro</H1>

<P class=T>In alcune circostanze è possibile che si desideri utilizzare <A HREF="javascript:HelpPopup('actip9.hlp','defValidationRule');" class="pop">regole di convalida</A> che dipendono da condizioni complesse, per poi eseguire azioni diverse a seconda delle condizioni. Dal momento che ad esempio le regole per i codici di avviamento postale sono diverse da Paese a Paese, un database in cui vengono memorizzati i CAP di molti Paesi non può basarsi su una semplice regola di convalida per garantire l'immissione corretta del CAP.</P>

<P class=T>È possibile però creare una macro che consenta di controllare quale Paese viene immesso nel controllo Paese e che il valore immesso nel controllo CAP sia corretto per quel Paese.</P>

<P class=T>Creare una macro che consenta di visualizzare messaggi diversi a seconda del valore del controllo Paese e della lunghezza dell'immissione nel controllo CAP.</P>

<P class=ART><IMG SRC="images/cmactsk7.bmp" ALT="Convalidare i dati utilizzando una macro" BORDER=0></P>

<P class=T>Aprire infine la maschera che contiene i controlli in <A HREF="javascript:HelpPopup('actip9.hlp','defDesignViewForm');" class="pop">visualizzazione Struttura</A> e impostare la proprietà di evento <B>Prima di aggiornare</B> della maschera al nome della macro. Viene utilizzata la proprietà della maschera invece di quella del controllo in quanto la convalida richiede due controlli diversi della maschera.</P>

<P class=T>Quando verrà utilizzata la maschera per aggiungere un nuovo fornitore, la macro di convalida verrà eseguita una volta inserito il nuovo record, ma prima che lo stesso venga salvato nella tabella Fornitori. Se una delle condizioni della macro è stata soddisfatta, viene visualizzato il messaggio appropriato e il record non viene salvato nella tabella Fornitori.</P>


<P>
<OBJECT ID="hhobj_AR" TYPE="application/x-oleobject" CLASSID="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM NAME="Command" VALUE="ALink">
<PARAM NAME="Font" VALUE="Verdana,8,1">
<PARAM NAME="Text" VALUE="Text:Risorse aggiuntive">
<PARAM NAME="Flags" VALUE=",,1">
<PARAM NAME="Item1" VALUE="">
<PARAM NAME="Item2" VALUE="acconExampleMacroValidationSW">
</OBJECT>
</P>
<SCRIPT language="VBScript" src="ShowMe_Code.vbs"></SCRIPT>
<SCRIPT language="VBSCRIPT">
Sub HelpPopup(sFile,sID)
L_SecurityT1_ErrorMessage="Impossibile visualizzare la procedura per la presenza di impostazioni di protezione "
L_SecurityT2_ErrorMessage="del browser troppo restrittive o per l'errata installazione del controllo ActiveX "
L_SecurityT3_ErrorMessage="Ouactrl.ocx."
L_SecurityE1_ErrorMessage="- Impostare un livello inferiore di protezione del browser"
L_SecurityE2_ErrorMessage="- Se questo messaggio viene visualizzato dopo l'impostazione di un livello inferiore,"
L_SecurityE3_ErrorMessage="  rivolgersi all'amministratore di sistema per la verifica dell'installazione del controllo"
L_SecurityE4_ErrorMessage="  ActiveX Ouactrl.ocx, posto nella cartella in cui è installato Microsoft Office"
sSecurityMSG=L_SecurityT1_ErrorMessage & chr(13) & L_SecurityT2_ErrorMessage & chr(13) & L_SecurityT3_ErrorMessage & chr(13) & chr(13) & L_SecurityE1_ErrorMessage & chr(13) & L_SecurityE2_ErrorMessage & chr(13) & L_SecurityE3_ErrorMessage & chr(13) & L_SecurityE4_ErrorMessage
L_App_DialogTitle="Guida di Microsoft Office"
On Error Resume Next
r=oua.HelpPopup(sFile,sID)
If Err<>0 Then Msgbox sSecurityMSG,48,L_App_DialogTitle
End Sub
</SCRIPT>
</BODY>
</HTML>
